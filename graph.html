<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>Exmples git</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2" />
		<meta name="description" content="Pagina  de  Storn.es"/>
		<link href="http://www.storn.es/favicon.ico" rel="icon" type="image/x-icon" />
		<link rel="stylesheet" type="text/css" media="all" href="http://tools.storn.es/estil.css" />
<style>
* {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
body{
	overflow-x: hidden; 
}
#command{
    font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;
	height: 60px;
	padding-top: 30px;
	padding-left: 30px;
	font-size: x-large;
}
</style>
	</head>
	<body class="simplePage">
<div>
	<button class="change-mode" data-mode="branch">Branch</button>
	<button class="change-mode" data-mode="merge">Merge</button>
	<button class="change-mode" data-mode="rebase">Rebase</button>
	<button class="change-mode" data-mode="rebase-i">Rebase Interactive</button>
</div>
<div id="command">

</div>
<div>
<canvas id="gitGraph"></canvas>
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://code.ringle.org/js/gitgraph.js"></script>
<script>

var currentState = 1;
var mode = 'branch';

//$(document).keypress(function(event) {
$(document).on( "keydown", function(event) {
    var keycode = (event.keyCode ? event.keyCode : event.which);
	// Next
	if(keycode == 34 || keycode == 39) {
		next();
	}
	// Back
	if(keycode == 33 || keycode == 37) {
		back();
	}
});

$(function() {
	if(window.location.hash) {
		mode = window.location.hash.replace('#','');
	}
	$('#gitGraph').click(function(){
		next();
	});
	$('.change-mode').click(function(){
		mode = $(this).attr('data-mode');
		currentState = 1;
		drawStep(currentState);
	});

	drawStep(currentState);
});

function next(){
	currentState++;
	drawStep(currentState);
}

function back(){
	if (currentState == 1) {
		return;
	}
	currentState--;
	drawStep(currentState);
}
function drawStep(step){

var graphConfig = new GitGraph.Template({
    branch: {
        color: "#000000",
        lineWidth: 3,
        spacingX: 60,
        mergeStyle: "straight",
        showLabel: true,                // display branch names on graph
        labelFont: "normal 10pt Arial"
    },
    commit: {
        spacingY: -30,
        dot: {
            size: 8,
            strokeColor: "#000000",
            strokeWidth: 4
        },
        tag: {
            font: "normal 10pt Arial",
            color: "yellow"
        },
        message: {
            color: "black",
            font: "normal 12pt Arial",
            displayAuthor: false,
            displayBranch: false,
            displayHash: false,
        }
    },
    arrow: {
        size: 5,
        offset: 3
    }
});

var config = {
  template: graphConfig,
  mode: "extended",
  orientation: "vertical"
};

var gitgraph = new GitGraph(config);

	var master = gitgraph.branch("master");
	var bamaster = gitgraph.branch("master");

	$('#command').html('');
	var intStep = 1;
	if (mode == 'branch') {
		if (step >= intStep++) {
			bamaster.commit({message:"Primer commit de l'exemple de branch"});
			if (step >= intStep++) {
				bamaster.commit({message:"Canvi directe a master"});
				if (step >= intStep++) {
					var bafeature1 = bamaster.branch("feature1").commit({message:"Es crea una branch per la feature 1"});

					if (step >= intStep++) {
						var bafeature2 = bamaster.branch("feature2").commit({message:"Es crea una altra branch per la feature 2 desde master"});
						if (step >= intStep++) {
							bamaster.commit({message:"Commit de hotfix a master"});
							bafeature1.commit({message:"Continuem la feina a la feature 1"});
							if (step >= intStep++) {
								bamaster.commit({message:"Seguim fent fixs que l'hem liat molt"}).commit({message:"Sembla que ja esta arreglat"});

								if (step >= intStep++) {
									var bafeature22 = bafeature2.branch("feature2.2").commit({message:"Fem una prova a partir de la feature 2"});
									if (step >= intStep++) {
										bafeature2.commit({message:"Pero seguin treballant amb la feature 2"});
									}
								}
							}
						}
					}
				}
			}

		}
	} else if (mode == 'merge') {
		if (step >= intStep++) {
			bamaster.commit({message:"Primer commit de l'exemple de merge"});
			if (step >= intStep++) {
				bamaster.commit({message:"Fem una mica de treball a master"});
				
				if (step >= intStep++) {
					var bafeature1 = gitgraph.branch("feature 1").commit({message:"Creem una branch per la feature 1"});

					if (step >= intStep++) {
						bamaster.commit({message:"Pero a master continua la feina"});
						if (step >= intStep++) {
							bafeature1.commit({message:"Desenvolupem la feature 1"}).commit({message:"Acabem la feature 1"});
							if (step >= intStep++) {
								bafeature1.merge(bamaster);
								if (step >= intStep++) {
									bamaster.commit({message:"I ara ja tenim a master els canvis de la feature 1"});
								}
							}
						}
					}
				}
			}
		}
	} else if (mode == 'rebase') {
		if (step <= 1) {
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 2"});

			var bafeature1 = bamaster.branch("feature 1").commit({message:"Commit feature 1.1"});
		} else if (step == 2 || step == 3) {
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 2"});

			var bafeature1 = bamaster.branch("feature 1").commit({message:"Commit feature 1.1"});

			bamaster.commit({message:"Commit 3"});
			bafeature1.commit({message:"Commit feature 1.2"});
			bamaster.commit({message:"Commit 4"});
			bamaster.commit({message:"Commit 5"});
			bamaster.commit({message:"Commit 6"});
			bamaster.commit({message:"Commit 7"});

			if (step == 3) {
				$('#command').html('$ git rebase master');
			}

		} else if (step == 4) {
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 2"});

			bamaster.commit({message:"Commit 3"});
			bamaster.commit({message:"Commit 4"});
			bamaster.commit({message:"Commit 5"});
			bamaster.commit({message:"Commit 6"});
			bamaster.commit({message:"Commit 7"});

			var bafeature1 = bamaster.branch("feature 1").commit({message:"Commit feature 1.1"});
			bafeature1.commit({message:"Commit feature 1.2"});
		}

	} else if (mode == 'rebase-i') {
		if (step <= 1) {
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 2"});
			bamaster.commit({message:"Commit 3"});
			bamaster.commit({message:"Commit 4"});
			bamaster.commit({message:"Commit 5"});
			bamaster.commit({message:"Commit 6"});
			bamaster.commit({message:"Commit 7"});
			bamaster.commit({message:"Commit 8"});
			bamaster.commit({message:"Commit 9"});
		} else if (step == 2) {
			$('#command').html('$ git rebase -i COMMIT2');
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 2"});
			bamaster.commit({message:"Commit 3, 4, 5 "});
			bamaster.commit({message:"Commit 6"});
			bamaster.commit({message:"Commit 7"});
			bamaster.commit({message:"Commit 8"});
			bamaster.commit({message:"Commit 9"});
		} else if (step == 3) {
			$('#command').html('$ git rebase -i COMMIT7');
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 2"});
			bamaster.commit({message:"Commit 3, 4, 5 "});
			bamaster.commit({message:"Commit 6"});
			bamaster.commit({message:"Commit 7"});
			bamaster.commit({message:"Commit 8, 9"});
		} else if (step >= 4) {
			$('#command').html('$ git rebase -i COMMIT1');
			bamaster.commit({message:"Commit 1"});
			bamaster.commit({message:"Commit 3, 4, 5 "});
			bamaster.commit({message:"Commit 6"});
			bamaster.commit({message:"Commit 7"});
			bamaster.commit({message:"Commit 8, 9"});
		}
	}}
/*
Docu: http://gitgraphjs.com/
Examples: http://code.ringle.org/gitflowsupport.html
*/
</script>
</body>
</html>